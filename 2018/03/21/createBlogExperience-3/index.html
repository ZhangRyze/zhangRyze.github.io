<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">

<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-97198147-1', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->



<title>第“二”次博客的经历（二） · ZRyze</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="author" content="zhangRyze">

<link rel="short icon" type="image/x-icon" href="/images/favicon-icon.png">

<link rel="stylesheet" href="/css/style.css">
<link rel="stylesheet" href="/css/blog_basic.css">
<link rel="stylesheet" href="/css/fonts/iconfont.css">
<script src="/js/jquery.min.js"></script>
<script src="/js/script.js"></script>
</head>
<body>
    <div class="sidebar animated fadeInDown">
	<div class="logo-title">
		<div class="avatar">
			<img src="/images/logo@2x.png">
		</div>
		<h3 title=''>
			<a href="/">ZRyze</a>
		</h3>
		<div class="description">“不轻狂，枉年少”</div>
	</div>
	<ul class="nav-list">
        
    <li>
        
            <a href="/">首页</a>
        
    </li>

    <li>
        
            <a href="/archives">归档</a>
        
    </li>

    <li>
        
            <a href="/tagcloud">标签云</a>
        
    </li>

    <li>
        
            <a href="/about">关于</a>
        
    </li>


	</ul>
	<ul class="social-links">
		
		
		
		
			<li class="icon-weibo">
				<a href="https://weibo.com/u/2285298924">
					<i class="iconfont ic-weibo"></i>
				</a>
			</li>
		
		
		
			<li class="icon-github">
				<a href="https://github.com/zhangRyze">
					<i class="iconfont ic-github"></i>
				</a>
			</li>
		
		
			<li class="icon-search">
				<a href="javascript:void(0)" onclick="openSearch()">
					<i class="iconfont ic-search"></i>
				</a>
			</li>
		
	</ul>
	<div class="footer">
	<!-- <div class="by_farbox">
  		<a href="https://github.com/Ben02/hexo-theme-Anatole" target="_blank">Theme adapted from Anatole</a>
	</div> -->
	<div class="by_farbox">
    	<a href="https://hexo.io/zh-cn/" target="_blank">Proudly published with Hexo&#65281</a>
	</div>
</div>

</div>

    <div class="main">
        <div class="content">
	<div class="post-page">
    	<div class="post animated fadeInDown">
    <div class="post-title">
        <h3>
            
                <a>第“二”次博客的经历（二）</a>
            
        </h3>
    </div>
    
        <div class="post-info">
    <div>
        
            <div>
                <i class="iconfont ic-category"></i>
                
                    <a href="/categories/自个儿折腾/" title="自个儿折腾" class="tag">自个儿折腾 </a>
                
            </div>
        
        
            <div>
                <i class="iconfont ic-tag"></i>
                
                    <a href="/tags/Hexo/" title="Hexo" class="tag">Hexo </a>
                
                    <a href="/tags/valine/" title="valine" class="tag">valine </a>
                
                    <a href="/tags/LeanCloud/" title="LeanCloud" class="tag">LeanCloud </a>
                
            </div>
        
    </div>
    <div>
        <div>
            <i class="iconfont ic-date"></i>
            <div class="date">2018-03-21</div>
        </div>
        <div class="post-hits" id="post-/2018/03/21/createBlogExperience-3/" data-post-path="/2018/03/21/createBlogExperience-3/" data-post-title="第“二”次博客的经历（二）"></div>
    </div>
</div>

        <div class="post-content"><p>完整的博客系统是需要评论系统和统计系统的（PS：自我感觉应该的），所以在折腾完博客以后花了点时间研究了下评论系统和统计系统。</p>
<hr>
<p>查了一堆资料，发现目前博客站点使用的评论功能，多说、网易云跟贴、友言都已经下线。Disqus也被挡在墙外。</p>
<p>可用的评论系统大概知道几个：</p>
<ul>
<li><a href="https://www.hypercomments.com" target="_blank" rel="noopener">HyperComments</a> - 貌似来自俄罗斯的评论系统，看了一会搞不懂，语言能力太次（PASS）。</li>
<li><a href="https://livere.com" target="_blank" rel="noopener">来必力</a> - 韩国的。</li>
<li><a href="http://changyan.kuaizhan.com" target="_blank" rel="noopener">畅言</a> - 需要备案，需要域名，我没有（PASS）。</li>
<li><a href="https://github.com/xCss/Valine" target="_blank" rel="noopener">Valine</a> / <a href="https://valine.js.org" target="_blank" rel="noopener">Valine中文教程</a> - 基于 <code>Leancloud</code> 数据管理的简约风格系统，好，就它了，正好我后面的统计系统用的也是 <code>Leancloud</code>。</li>
</ul>
<h3 id="Valine"><a href="#Valine" class="headerlink" title="Valine"></a>Valine</h3><h5 id="引用"><a href="#引用" class="headerlink" title="引用"></a>引用</h5><p>需要在你的博客系统引用两个 <code>javaScript</code>:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;script src=<span class="string">"//cdn1.lncld.net/static/js/3.0.4/av-min.js"</span>&gt;&lt;/script&gt;</span><br><span class="line">&lt;script src=<span class="string">'//unpkg.com/valine/dist/Valine.min.js'</span>&gt;&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<h5 id="获取-AppId-和-AppKey"><a href="#获取-AppId-和-AppKey" class="headerlink" title="获取 AppId 和 AppKey"></a>获取 AppId 和 AppKey</h5><p>请先 <a href="https://leancloud.cn/dashboard/login.html#/signin" target="_blank" rel="noopener">登录</a> 或 <a href="https://leancloud.cn/dashboard/login.html#/signup" target="_blank" rel="noopener">注册</a> <code>Leancloud</code> ，进入控制台后点击左下角 <code>创建应用</code>：<br><img src="/2018/03/21/createBlogExperience-3/step_1.jpg" alt="创建应用"><br>应用创建好以后，进入刚刚创建的应用，选择左下角的 <code>设置</code> &gt; <code>应用Key</code>，然后就能看到你的 <code>appid</code> 和 <code>appkey</code> 了：<br><img src="/2018/03/21/createBlogExperience-3/step_2.jpg" alt="appid和appkey"></p>
<blockquote>
<p>为了您的数据安全，请注意设置自己的 <code>安全域名</code>：</p>
</blockquote>
<p><img src="/2018/03/21/createBlogExperience-3/step_3.jpg" alt="安全域名"></p>
<h5 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h5><p>在 <code>theme</code> 中的 <code>_config.yml</code> 添加：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># LeanCloud支持</span></span><br><span class="line">LeanCloud:</span><br><span class="line">  <span class="built_in">enable</span>: <span class="literal">true</span></span><br><span class="line">  appid: H4lyfaqzxLrMuHbyHDohIFvf-gzGzoHsz <span class="comment"># your leancloud application appid</span></span><br><span class="line">  appkey: 22gf5wKdGEiPgbbGCyUtz0fr <span class="comment"># your leancloud application appkey</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># valine支持</span></span><br><span class="line">valine:</span><br><span class="line">  <span class="built_in">enable</span>: <span class="literal">true</span> <span class="comment"># 如果使用valine，请设置改之为true</span></span><br><span class="line">  notify: <span class="literal">false</span> <span class="comment"># 评论回复邮件提醒 , https://github.com/xCss/Valine/wiki</span></span><br><span class="line">  verify: <span class="literal">false</span> <span class="comment"># 验证码服务</span></span><br><span class="line">  placeholder: 说点什么吧 <span class="comment"># 评论框占位提示符</span></span><br><span class="line">  avatar: monsterid <span class="comment"># Gravatar 头像展示方式</span></span><br><span class="line">  guest_info: nick,mail <span class="comment"># 评论者相关属性 nick/mail/link</span></span><br><span class="line">  pageSize: 10 <span class="comment"># 评论列表分页，每页条数</span></span><br></pre></td></tr></table></figure>
<p>然后需要在页面初始化的时候初始化 <code>valine</code>，我则是在博客系统中创建了一个 <code>comments</code> 的组件，包括上面提到的引用都在这里：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;% <span class="keyword">if</span> (theme.valine.enable)&#123; %&gt;</span><br><span class="line">    &lt;script src=<span class="string">"//cdn1.lncld.net/static/js/3.0.4/av-min.js"</span>&gt;&lt;/script&gt;</span><br><span class="line">    &lt;script src=<span class="string">"//unpkg.com/valine/dist/Valine.min.js"</span>&gt;&lt;/script&gt;</span><br><span class="line">    &lt;div id=<span class="string">"comment"</span> class=<span class="string">"comment"</span> &gt;&lt;/div&gt;</span><br><span class="line">    &lt;script&gt;</span><br><span class="line">        var notify = <span class="string">'&lt;%= theme.valine.notify %&gt;'</span> == <span class="literal">true</span> ? <span class="literal">true</span> : <span class="literal">false</span>;</span><br><span class="line">        var verify = <span class="string">'&lt;%= theme.valine.verify %&gt;'</span> == <span class="literal">true</span> ? <span class="literal">true</span> : <span class="literal">false</span>;</span><br><span class="line">        var GUEST_INFO = [<span class="string">'nick'</span>,<span class="string">'mail'</span>,<span class="string">'link'</span>];</span><br><span class="line">        var guest_info = <span class="string">'&lt;%= theme.valine.guest_info %&gt;'</span>.split(<span class="string">','</span>).filter(<span class="keyword">function</span>(item)&#123;</span><br><span class="line">            <span class="built_in">return</span> GUEST_INFO.indexOf(item) &gt; -1</span><br><span class="line">        &#125;);</span><br><span class="line">        guest_info = guest_info.length == 0 ? GUEST_INFO :guest_info;</span><br><span class="line">        window.valine = new Valine(&#123;</span><br><span class="line">            el: <span class="string">'#comment'</span>,</span><br><span class="line">            notify: notify,</span><br><span class="line">            verify: verify,</span><br><span class="line">            appId: <span class="string">"&lt;%= theme.LeanCloud.appid %&gt;"</span>,</span><br><span class="line">            appKey: <span class="string">"&lt;%= theme.LeanCloud.appkey %&gt;"</span>,</span><br><span class="line">            avatar:<span class="string">'&lt;%= theme.valine.avatar %&gt;'</span>,</span><br><span class="line">            placeholder: <span class="string">"&lt;%= theme.valine.placeholder %&gt;"</span>,</span><br><span class="line">            guest_info:guest_info,</span><br><span class="line">            pageSize:<span class="string">'&lt;%= theme.valine.pageSize %&gt;'</span></span><br><span class="line">        &#125;);</span><br><span class="line">    &lt;/script&gt;</span><br><span class="line">&lt;% &#125; %&gt;</span><br></pre></td></tr></table></figure>
<p>然后在需要评论的地方添加这个组件。</p>
<blockquote>
<p>我使用的模板引擎是 <code>ejs</code></p>
</blockquote>
</div>
    
</div>

    	<div class="share">
			<a class="evernote" href="javascript:(function(){EN_CLIP_HOST='http://www.evernote.com';try{var%20x=document.createElement('SCRIPT');x.type='text/javascript';x.src=EN_CLIP_HOST+'/public/bookmarkClipper.js?'+(new%20Date().getTime()/100000);document.getElementsByTagName('head')[0].appendChild(x);}catch(e){location.href=EN_CLIP_HOST+'/clip.action?url='+encodeURIComponent(location.href)+'&title='+encodeURIComponent(document.title);}})();", ref="nofollow", target="_blank">
				<i class="iconfont ic-evernote"></i>
			</a>
			<a class="weibo" href="javascript:void((function(s,d,e){try{}catch(e){}var f='http://service.weibo.com/share/share.php?',u=d.location.href,p=['url=',e(u),'&title=',e(d.title),'&appkey=2924220432'].join('');function a(){if(!window.open([f,p].join(''),'mb',['toolbar=0,status=0,resizable=1,width=620,height=450,left=',(s.width-620)/2,',top=',(s.height-450)/2].join('')))u.href=[f,p].join('');};if(/Firefox/.test(navigator.userAgent)){setTimeout(a,0)}else{a()}})(screen,document,encodeURIComponent));">
				<i class="iconfont ic-weibo"></i>
			</a>
    	</div>
		<div class="pagination">
	<ul class="clearfix">
		
			<li class="pre pagbuttons">
				
			</li>
			<li class="next pagbuttons">
				
				<a href="/2018/03/20/createBlogExperience-2/" role="navigation" class="btn">下一页</a>
				
			</li>
	</ul>
</div>


    	
    		
    <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
    <script src="//unpkg.com/valine/dist/Valine.min.js"></script>
    <div id="comment" class="comment" ></div>
    <script>
        var notify = 'false' == true ? true : false;
        var verify = 'false' == true ? true : false;
        var GUEST_INFO = ['nick','mail','link'];
        var guest_info = 'nick,mail'.split(',').filter(function(item){
            return GUEST_INFO.indexOf(item) > -1
        });
        guest_info = guest_info.length == 0 ? GUEST_INFO :guest_info;
        window.valine = new Valine({
            el: '#comment',
            notify: notify,
            verify: verify,
            appId: "H4lyfaqzxLrMuHbyHDohIFvf-gzGzoHsz",
            appKey: "22gf5wKdGEiPgbbGCyUtz0fr",
            avatar:'monsterid',
            placeholder: "说点什么吧",
            guest_info:guest_info,
            pageSize:'10'
        });
    </script>

    	
	</div>
</div>

    </div>
    
    <div id="local-search-box" class="local-search-box" style="display: none">
        <input class="local-search-input" type="text" id="local-search-input" name="q" results="0" placeholder="搜索" />
        <div class="local-search-list" id="local-search-result">
            <div class="local-search-prompt">搜一搜看看吧 ~</div>
        </div>
    </div>

    <div id="modal-container-bg" class="modal-container-bg" style="display: none" onclick="closeSearch()"></div>
    <!-- js start -->
	<script src="/js/av-live-query.js"></script>
    <script>
		AV.initialize("H4lyfaqzxLrMuHbyHDohIFvf-gzGzoHsz","22gf5wKdGEiPgbbGCyUtz0fr");
        $(function(){
	    
	            document.onkeydown = function(event) {
	                var e = event || window.event || arguments.callee.caller.arguments[0];
	                if (e && e.keyCode == 27) { // 按 Esc
	                    closeSearch() //要做的事情
	                }
	            };

	            var Counter = AV.Object.extend("Counter");
	            // in post.html, so add 1 to hit counts
	            addCount(Counter);
	    
        })
    </script>
    
		<script src="/js/search.my.js"></script>
    
</body>
</html>